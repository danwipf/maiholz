(this["webpackJsonpsauna-app"]=this["webpackJsonpsauna-app"]||[]).push([[0],{17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(8),o=a.n(r),c=(a(5),a(3)),s=a(2);a(17);var m=function(e){let{children:t}=e;const[a,r]=Object(n.useState)(!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement("header",{className:"header"},l.a.createElement("h1",{className:"logo"},"Sauna"),l.a.createElement("div",{className:"menu-toggle",onClick:()=>r(!a)},"\u2630"),l.a.createElement("nav",{className:"nav "+(a?"open":"")},l.a.createElement(c.b,{to:"/",onClick:()=>r(!1)},"Setting"),l.a.createElement(c.b,{to:"/dashboard",onClick:()=>r(!1)},"Dashboard"))),l.a.createElement("main",{className:"main-content"},t))};var i=function(e){let{onUpdate:t}=e;return l.a.createElement("div",{style:{marginTop:"1rem"}},l.a.createElement("label",null,l.a.createElement("strong",null,"Importiere XML-Einstellungen:")," ",l.a.createElement("input",{type:"file",accept:".xml",onChange:e=>{const a=e.target.files[0];if(!a)return;const n=new FileReader;n.onload=e=>{const a=(new DOMParser).parseFromString(e.target.result,"text/xml"),n=e=>{var t;return(null===(t=a.getElementsByTagName(e)[0])||void 0===t?void 0:t.textContent)||""},l={deviceIDSauna:n("deviceIDSauna"),deviceIDHotPot:n("deviceIDHotPot"),token:n("token"),baseURL:n("baseURL"),timestampoffset:n("timestampoffset")};for(const[t,r]of Object.entries(l))localStorage.setItem(t,r);t(l),alert("Einstellungen wurden erfolgreich importiert.")},n.readAsText(a)}})))};var u=function(){const[e,t]=Object(n.useState)(localStorage.getItem("deviceIDSauna")||""),[a,r]=Object(n.useState)(localStorage.getItem("deviceIDHotPot")||""),[o,c]=Object(n.useState)(localStorage.getItem("token")||""),[m,u]=Object(n.useState)(localStorage.getItem("baseURL")||""),[d,g]=Object(n.useState)(localStorage.getItem("timestampoffset")||""),h=Object(s.q)();return l.a.createElement("div",{className:"settings-container"},l.a.createElement("form",{className:"settings-box",onSubmit:e=>{e.preventDefault(),localStorage.setItem("deviceIDSauna","d8bfc01a555e"),localStorage.setItem("deviceIDHotPot","Nicht Installiert"),localStorage.setItem("token",o),localStorage.setItem("baseURL",m),localStorage.setItem("timestampoffset",7200),t("d8bfc01a555e"),r("Nicht Installiert"),g(7200),h("/dashboard")}},l.a.createElement("h1",null,"Setting"),l.a.createElement("h3",null,"Shelly DeviceID"),l.a.createElement("h2",null,"Sauna: ",localStorage.getItem("deviceIDSauna")),l.a.createElement("h2",null,"HotPot: ",localStorage.getItem("deviceIDHotPot")),l.a.createElement("h3",null,"Token"),l.a.createElement("input",{type:"text",placeholder:"Token",value:o,onChange:e=>c(e.target.value),required:!0}),l.a.createElement("h3",null,"BaseURL"),l.a.createElement("input",{type:"text",placeholder:"BaseURL",value:m,onChange:e=>u(e.target.value),required:!0}),l.a.createElement("h3",null,"Time Stamp Offset"),l.a.createElement("input",{type:"text",placeholder:"Time Stamp Offset",value:d,onChange:e=>g(e.target.value),required:!0}),l.a.createElement(i,{onUpdate:e=>{let{deviceIDSauna:a,deviceIDHotPot:n,token:l,baseURL:o,timestampoffset:s}=e;t(a),r(n),c(l),u(o),g(s)}}),l.a.createElement("button",{type:"submit"},"Speichern")))};var d=function(){const e=localStorage.getItem("deviceIDSauna"),t=localStorage.getItem("token"),a=localStorage.getItem("baseURL"),r=localStorage.getItem("timestampoffset"),[o,c]=Object(n.useState)(null);return Object(n.useEffect)(()=>{let n;const l=async()=>{try{const n=await fetch(`${a}/device/status?id=${e}&auth_key=${t}`),l=await n.json(),o=l.data.device_status.unixtime,s=l.data.device_status.relays[0].timer_started,m=l.data.device_status.relays[0].timer_duration,i=Math.floor(Date.now()/1e3),u=s+m-(o+(i-o))-r;c(Math.max(0,u))}catch(n){console.error("Timer Fehler:",n),c("Fehler")}};return l(),n=setInterval(l,1e3),()=>clearInterval(n)},[a,e,t]),l.a.createElement("div",{className:"settings-container"},l.a.createElement("div",{className:"settings-box"},l.a.createElement("h1",null,"Dashboard"),l.a.createElement("button",{onClick:async()=>{try{await fetch(a+"/device/relay/control",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:e,auth_key:t,channel:0,turn:"toggle"})})}catch(n){alert("Netzwerkfehler: "+n.message)}}},"Sauna ein-/ausschalten"),l.a.createElement("div",{style:{marginTop:"1rem"}},l.a.createElement("strong",null,"Verbleibende Zeit:")," ","number"===typeof o?o+" Sekunden":o)))};var g=function(){const e=localStorage.getItem("username")&&localStorage.getItem("password");return l.a.createElement(c.a,null,l.a.createElement(m,null,l.a.createElement(s.d,null,l.a.createElement(s.b,{path:"/",element:l.a.createElement(u,null)}),l.a.createElement(s.b,{path:"/dashboard",element:e?l.a.createElement(d,null):l.a.createElement(s.a,{to:"/settings"})}))))};var h=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,19)).then(t=>{let{getCLS:a,getFID:n,getFCP:l,getLCP:r,getTTFB:o}=t;a(e),n(e),l(e),r(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(g,null))),h()},5:function(e,t,a){},9:function(e,t,a){e.exports=a(18)}},[[9,1,2]]]);
//# sourceMappingURL=main.ac3b6310.chunk.js.map